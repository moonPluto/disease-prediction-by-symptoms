import pandas as pd
import re
import numpy as np
import pickle
from flask import Flask, request, jsonify, render_template
rfc=pickle.load(open("store/rfc.pkl","rb"))
med=pd.read_csv('csvfile/medications.csv')
diets=pd.read_csv('csvfile/diets.csv')
descr = pd.read_csv('csvfile/description.csv', encoding='latin1')
work=pd.read_csv('csvfile/workout_df.csv')
simp={'mucoid sputum': 0, 'blackheads': 1, 'mood swings': 2, 'movement stiffness': 3, 'bladder discomfort': 4, 'swelling joints': 5, 'yellow urine': 6, 'increased appetite': 7, 'loss of balance': 8, 'indigestion': 9, 'weight loss': 10, 'weakness in limbs': 11, 'scurring': 12, 'spinning movements': 13, 'swollen blood vessels': 14, 'continuous feel of urine': 15, 'chest pain': 16, 'visual disturbances': 17, 'red sore around nose': 18, 'small dents in nails': 19, 'blood in sputum': 20, 'stiff neck': 21, 'belly pain': 22, 'malaise': 23, 'painful walking': 24, 'rusty sputum': 25, 'swollen extremeties': 26, 'congestion': 27, 'ulcers on tongue': 28, 'red spots over body': 29, 'passage of gases': 30, 'neck pain': 31, 'dark urine': 32, 'sinus pressure': 33, 'lack of concentration': 34, 'stomach bleeding': 35, 'back pain': 36, 'knee pain': 37, 'foul smell of urine': 38, 'pain during bowel movements': 39, 'high fever': 40, 'slurred speech': 41, 'irregular sugar level': 42, 'phlegm': 43, 'cough': 44, 'stomach pain': 45, 'obesity': 46, 'watering from eyes': 47, 'prominent veins on calf': 48, 'patches in throat': 49, 'yellowing of eyes': 50, 'abnormal menstruation': 51, 'cold hands and feets': 52, 'internal itching': 53, 'pus filled pimples': 54, 'abdominal pain': 55, 'swelled lymph nodes': 56, 'spotting  urination': 57, 'history of alcohol consumption': 58, 'puffy face and eyes': 59, 'pain behind the eyes': 60, 'palpitations': 61, 'sunken eyes': 62, 'drying and tingling lips': 63, 'runny nose': 64, 'blurred and distorted vision': 65, 'nodal skin eruptions': 66, 'extra marital contacts': 67, 'polyuria': 68, 'muscle weakness': 69, 'continuous sneezing': 70, 'distention of abdomen': 71, 'lethargy': 72, 'mild fever': 73, 'muscle wasting': 74, 'redness of eyes': 75, 'muscle pain': 76, 'weight gain': 77, 'bloody stool': 78, 'silver like dusting': 79, 'irritation in anus': 80, 'dischromic  patches': 81, 'restlessness': 82, 'acute liver failure': 83, 'cramps': 84, 'inflammatory nails': 85, 'loss of appetite': 86, 'receiving unsterile injections': 87, 'excessive hunger': 88, 'fast heart rate': 89, 'blister': 90, 'swollen legs': 91, 'hip joint pain': 92, 'yellowish skin': 93, 'altered sensorium': 94, 'breathlessness': 95, 'chills': 96, 'enlarged thyroid': 97, 'acidity': 98, 'brittle nails': 99, 'skin rash': 100, 'pain in anal region': 101, 'receiving blood transfusion': 102, 'skin peeling': 103, 'family history': 104, 'unsteadiness': 105, 'yellow crust ooze': 106, 'weakness of one body side': 107, 'loss of smell': 108, 'sweating': 109, 'joint pain': 110, 'fluid overload': 111, 'toxic look (typhos)': 112, 'burning micturition': 113, 'swelling of stomach': 114, 'throat irritation': 115, 'abdominal cramp': 116, 'abdominal distention': 117, 'abnormal behavior': 118, 'abnormal bleeding': 119, 'abnormal sensation': 120, 'abnormally frequent': 121, 'abscess': 122, 'aching': 123, 'acne': 124, 'acquiring drinking alcohol taking lot time': 125, 'affected part turning white': 126, 'anemia': 127, 'arm': 128, 'attack pain': 129, 'back': 130, 'bacterial infection': 131, 'bad breath': 132, 'bad smelling thin vaginal discharge': 133, 'bad smelling vaginal discharge': 134, 'barky cough': 135, 'belching': 136, 'better sitting worse lying': 137, 'birth baby younger week gestational age': 138, 'bleeding gum': 139, 'bleeding skin': 140, 'blindness': 141, 'blindness one eye': 142, 'blister sunlight': 143, 'bloating': 144, 'blood stool': 145, 'blood urine': 146, 'bloody diarrhea': 147, 'blue': 148, 'bluish skin coloration': 149, 'blurred vision': 150, 'blurry vision': 151, 'body tremor': 152, 'bone pain': 153, 'bowed leg': 154, 'breakdown skeletal muscle': 155, 'breathing problem': 156, 'burning': 157, 'burning redness eye': 158, 'burning stabbing pain': 159, 'burning urination': 160, 'certain thought repeatedly': 161, 'change bowel movement': 162, 'change breast shape': 163, 'change color': 164, 'change hair': 165, 'change reflex': 166, 'change skin color red black': 167, 'change sleeping eating pattern': 168, 'change taste': 169, 'change voice': 170, 'characteristic facial feature': 171, 'characteristic rash': 172, 'chest discomfort': 173, 'chest pain.1': 174, 'chest tightness': 175, 'chill': 176, 'chronic cough': 177, 'chronic pain bladder': 178, 'clenched fist overlapping finger': 179, 'close object appear blurry': 180, 'clumsy': 181, 'cm lump skin': 182, 'cold sweat': 183, 'confused thinking': 184, 'confusion': 185, 'coolness': 186, 'coordination': 187, 'cough bloody mucus': 188, 'cough sputum production': 189, 'coughing': 190, 'coughing blood': 191, 'coughing including coughing blood': 192, 'coughing mucus': 193, 'crawl': 194, 'cry episode': 195, 'dark urine.1': 196, 'darker': 197, 'daytime sleepiness': 198, 'death child le one year age': 199, 'decreased ability feel pain': 200, 'decreased ability see': 201, 'decreased ability think': 202, 'decreased ability think remember': 203, 'decreased ability turn': 204, 'decreased appetite': 205, 'decreased motivation': 206, 'decreased range motion': 207, 'decreased taste': 208, 'decreased vision': 209, 'delayed physical growth': 210, 'delirium': 211, 'delusion': 212, 'dementia': 213, 'depending subtype abdominal pain': 214, 'depends organ involved': 215, 'depressed mood': 216, 'dermatitis herpetiformis': 217, 'developmental disability': 218, 'diarrhea': 219, 'diarrhea may bloody': 220, 'diarrhea mixed blood': 221, 'difficulty breathing': 222, 'difficulty cutting': 223, 'difficulty eating': 224, 'difficulty getting pregnant': 225, 'difficulty remembering recent event': 226, 'difficulty swallowing': 227, 'difficulty walking': 228, 'dimpling skin': 229, 'discharge penis': 230, 'disorientation': 231, 'distant object appear blurry': 232, 'distorted blurred vision distance': 233, 'double vision': 234, 'drinking large amount alcohol long period': 235, 'drooping eyelid': 236, 'dry cough': 237, 'dry damp skin': 238, 'dry eye': 239, 'dry mouth': 240, 'ear pain': 241, 'easy prolonged bleeding': 242, 'emotional problem': 243, 'enlarged lymph node neck': 244, 'enlarged spleen': 245, 'enlarged thyroid.1': 246, 'enlargement thyroid': 247, 'enlargement tonsil': 248, 'episode severe': 249, 'erythema marginatum': 250, 'excess hair': 251, 'excessive amount uterine bleeding': 252, 'excessive daytime sleepiness': 253, 'excessive salivation': 254, 'expanding area redness site tick bite': 255, 'extreme sadness': 256, 'extremity weakness': 257, 'eye pain': 258, 'eye strain': 259, 'eyestrain': 260, 'fast heart rate.1': 261, 'fast heartbeat': 262, 'fear water': 263, 'feel need check thing repeatedly': 264, 'feeling cold': 265, 'feeling faint upon standing': 266, 'feeling generally unwell': 267, 'feeling like passing': 268, 'feeling need urinate right away': 269, 'feeling tired': 270, 'feeling tired time': 271, 'fever': 272, 'firm': 273, 'flat discolored spot bump may blister': 274, 'flu like illness': 275, 'flu like symptom': 276, 'fluid filled blister scab': 277, 'fluid nipple': 278, 'frequent infection': 279, 'frequent urination': 280, 'fullness': 281, 'gas': 282, 'gradual loss coordination': 283, 'growth delay': 284, 'gum disease': 285, 'hair loss': 286, 'half ring finger': 287, 'hallucination': 288, 'hallucination usually hearing voice': 289, 'hard swelling skin': 290, 'hard time reading small print': 291, 'hearing loss': 292, 'hearing sound external sound present': 293, 'heartburn': 294, 'heat intolerance': 295, 'heavy period': 296, 'high blood pressure': 297, 'high body temperature': 298, 'hoarse voice': 299, 'hold reading material farther away': 300, 'impaired communication': 301, 'inability child': 302, 'inability move facial muscle one side': 303, 'inability move feel one side body': 304, 'increased breath rate': 305, 'increased breathing rate': 306, 'increased fat': 307, 'increased heart rate': 308, 'increased hunger': 309, 'increased risk broken bone': 310, 'increased risk infection': 311, 'increased thirst': 312, 'increasing weakening': 313, 'index': 314, 'infertility': 315, 'inflamed eye': 316, 'insomnia': 317, 'intellectual disability': 318, 'involuntary muscle movement': 319, 'involuntary sleep episode': 320, 'irregular edge': 321, 'irregular menstrual period': 322, 'irregular menstruation': 323, 'irritation': 324, 'itchiness': 325, 'itching genital area': 326, 'itching result trouble sleeping': 327, 'itchy': 328, 'itchy blister': 329, 'itchy bump': 330, 'itchy ear': 331, 'jaundice': 332, 'jaw': 333, 'jerky body movement': 334, 'joint bone pain': 335, 'joint swelling': 336, 'large amount watery diarrhea': 337, 'large forehead': 338, 'large lymph node': 339, 'large lymph node around neck': 340, 'leg swelling': 341, 'light sensitivity': 342, 'little pain': 343, 'localized breast pain redness': 344, 'long term fatigue': 345, 'loose frequent bowel movement': 346, 'loose teeth': 347, 'loss appetite': 348, 'loss consciousness may sweating': 349, 'loss hair part head body': 350, 'loss lot blood childbirth': 351, 'loss smell': 352, 'loss vision one side': 353, 'low blood pressure': 354, 'low energy': 355, 'low red blood cell': 356, 'lower abdominal pain': 357, 'lump breast': 358, 'lump bump neck': 359, 'maculopapular rash': 360, 'malabsorption': 361, 'may symptom': 362, 'memory problem': 363, 'mental ability': 364, 'mental change': 365, 'mid dilated pupil': 366, 'middle finger': 367, 'mild moderate intellectual disability': 368, 'minimal': 369, 'missed period': 370, 'mole increasing size': 371, 'mood change': 372, 'mood swing': 373, 'mouth sore': 374, 'mouth ulcer': 375, 'multiple painful joint': 376, 'muscle ache difficulty breathing': 377, 'muscle cramp': 378, 'muscle joint pain': 379, 'muscle spasm': 380, 'muscle weakness.1': 381, 'muscle weakness beginning foot hand': 382, 'muscle weakness resulting inability move': 383, 'muscular pain': 384, 'myalgia': 385, 'nausea vomiting': 386, 'nausea vomiting weight loss dehydration occur': 387, 'nearly undetectable spell': 388, 'nearsightedness': 389, 'neck': 390, 'neck stiffness': 391, 'needing urinate often': 392, 'newly inverted nipple': 393, 'non itchy skin ulcer': 394, 'non painful cyst middle eyelid': 395, 'nonaligned eye': 396, 'none non specific': 397, 'numbness': 398, 'object different size eye': 399, 'one eye myopia eye hyperopia': 400, 'opening upper lip may extend nose palate': 401, 'others': 402, 'overlying redness': 403, 'pain along inside edge shinbone': 404, 'pain area': 405, 'pain around ear': 406, 'pain doesnt go shingle': 407, 'pain going leg lower back': 408, 'pain sex': 409, 'pain specific bone': 410, 'painful': 411, 'painful blister lower leg': 412, 'painful heavy period': 413, 'painful joint base big toe': 414, 'painful rash occurring stripe': 415, 'painful skin': 416, 'painful swelling parotid gland': 417, 'painful swollen joint': 418, 'painful tender outer part elbow': 419, 'painless': 420, 'painless lump': 421, 'pale color': 422, 'pale skin': 423, 'pallor': 424, 'paralysis': 425, 'patch thick': 426, 'patch white skin': 427, 'perform certain routine repeatedly': 428, 'period vigorous shaking': 429, 'persistent rough white red patch mouth lasting longer week': 430, 'photophobia': 431, 'physical disability': 432, 'pimple like rash': 433, 'pinkish': 434, 'playing video game extremely long period time': 435, 'poor ability tolerate cold': 436, 'poor appetite': 437, 'poor coordination': 438, 'poor tolerance heat': 439, 'post nasal drip': 440, 'problem language': 441, 'problem mood': 442, 'problem understanding speaking': 443, 'problem vision': 444, 'profuse sweating': 445, 'progressive muscle weakness': 446, 'prolonged': 447, 'prolonged cough': 448, 'prominent': 449, 'protein urine': 450, 'psychosis': 451, 'pulsing pain': 452, 'purple colored skin affected area': 453, 'purple colored skin lesion': 454, 'raised': 455, 'raised red blue lesion': 456, 'random outburst laughter': 457, 'rapid breathing': 458, 'recurring episode wheezing': 459, 'red': 460, 'red eye': 461, 'red purple darker skin': 462, 'red rash': 463, 'red scaly patch skin breast': 464, 'red skin': 465, 'red spot white eye': 466, 'red without blister': 467, 'reddish eye': 468, 'redness': 469, 'redness eye': 470, 'repetitive behavior': 471, 'restricted interest': 472, 'right lower abdominal pain': 473, 'rigidity': 474, 'ringing ear heartbeat': 475, 'rough skin growth': 476, 'runny nose.1': 477, 'scaly patch skin': 478, 'scratchiness': 479, 'seizure': 480, 'sensitivity smell': 481, 'sensitivity sound': 482, 'severe intellectual disability': 483, 'severe pain': 484, 'severe pain lower back abdomen': 485, 'shakiness': 486, 'shaking': 487, 'sharp chest pain': 488, 'shock like pain one side face last second minute': 489, 'short height': 490, 'short stature': 491, 'shortness breath': 492, 'sit': 493, 'skin blister': 494, 'skin breakdown': 495, 'skin lesion generally pink color project outward': 496, 'skin peeling.1': 497, 'sleep problem': 498, 'sleeping problem': 499, 'slowness movement': 500, 'small': 501, 'small blister break open form painful ulcer': 502, 'small blister surrounding swelling': 503, 'small face': 504, 'small head': 505, 'small jaw': 506, 'sneezing': 507, 'social withdrawal': 508, 'sometimes symptom': 509, 'sore arm leg': 510, 'sore throat': 511, 'sore wrist': 512, 'stiff muscle': 513, 'stiff neck.1': 514, 'stiffness': 515, 'stomach pain.1': 516, 'stroke': 517, 'stuffy itchy nose': 518, 'stunted growth': 519, 'sudden': 520, 'sudden loss muscle strength': 521, 'sweat': 522, 'swell pain near tumor': 523, 'swelling': 524, 'swelling abdomen': 525, 'swelling around eye': 526, 'swelling hand foot': 527, 'swollen': 528, 'swollen hand foot': 529, 'swollen lymph node': 530, 'taste acid': 531, 'temporary fleeting vision one eye': 532, 'tender breast': 533, 'testicular pain': 534, 'tingling': 535, 'tingling hand foot': 536, 'tingling thumb': 537, 'tiredness': 538, 'tooth loss': 539, 'tremor': 540, 'triangular tissue growth cornea': 541, 'trouble breathing nose': 542, 'trouble coordination': 543, 'trouble opening mouth': 544, 'trouble seeing': 545, 'trouble sensation': 546, 'trouble sleeping': 547, 'trouble social interaction': 548, 'trouble speaking': 549, 'trouble swallowing': 550, 'trouble talking': 551, 'trouble walking': 552, 'typically none': 553, 'ulcer': 554, 'ulcer around genitals': 555, 'ulceration': 556, 'unable move': 557, 'unexplained weight loss': 558, 'unintended weight loss': 559, 'unpleasant smell present breath': 560, 'upper abdominal pain': 561, 'usage resulting problem': 562, 'vaginal bleeding': 563, 'vaginal bleeding without pain': 564, 'vaginal discharge': 565, 'variable': 566, 'vary depending part brain involved': 567, 'varying degree muscle weakness': 568, 'velvety skin': 569, 'vision loss': 570, 'warm': 571, 'wart': 572, 'watery eye': 573, 'weak grip': 574, 'weak muscle': 575, 'weakness limb': 576, 'weakness numbness affected leg': 577, 'webbed neck': 578, 'weight gain.1': 579, 'wet': 580, 'wheezing': 581, 'white patch vaginal discharge': 582, 'widespread pain': 583, 'withdrawal occurring stopping': 584, 'worrying': 585, 'yellow skin': 586, 'yellowish coloration skin white eye': 587, 'yellowish skin.1': 588, 'yellowish skin crust': 589, 'fatigue': 590, 'bruising': 591, 'constipation': 592, 'shivering': 593, 'depression': 594, 'itching': 595, 'dehydration': 596, 'coma': 597, 'nausea': 598, 'irritability': 599, 'dizziness': 600, 'headache': 601, 'vomiting': 602, 'diarrhoea': 603, 'anxiety': 604}
dimp={0: '(vertigo) Paroymsal  Positional Vertigo', 1: 'AIDS', 2: 'Abscess', 3: 'Acne', 4: 'Acquired Capillary Haemangioma of Eyelid', 5: 'Acquired Immuno Deficiency Syndrome', 6: 'Acute encephalitis syndrome', 7: 'Adult Inclusion Conjunctivitis', 8: 'Alcohol Abuse and Alcoholism', 9: 'Alcoholic hepatitis', 10: 'Allergy', 11: 'Alopecia (hair loss)', 12: 'Alzheimer', 13: 'Amaurosis Fugax', 14: 'Amblyopia', 15: 'Amoebiasis', 16: 'Anaemia', 17: 'Aniseikonia', 18: 'Anisometropia', 19: 'Antepartum hemorrhage (Bleeding in late pregnancy)', 20: 'Anthrax', 21: 'Anxiety', 22: 'Appendicitis', 23: 'Arthritis', 24: 'Asbestos-related diseases', 25: 'Aseptic meningitis', 26: 'Asthma', 27: 'Astigmatism', 28: 'Atrophy', 29: 'Autism', 30: 'Bad Breath (Halitosis)', 31: "Bell's Palsy", 32: 'Beriberi', 33: 'Black Death', 34: 'Bleeding Gums', 35: 'Blindness', 36: 'Botulism', 37: 'Brain Tumour', 38: 'Breast Cancer / Carcinoma', 39: 'Bronchial Asthma', 40: 'Bronchitis', 41: 'Brucellosis', 42: 'Bubonic plague', 43: 'Bunion', 44: 'Burns', 45: 'Calculi', 46: 'Campylobacter infection', 47: 'Cancer', 48: 'Candidiasis', 49: 'Carbon monoxide poisoning', 50: 'Carpal Tunnel Syndrome', 51: 'Cavities', 52: 'Celiacs disease', 53: 'Cerebral palsy', 54: 'Cervical spondylosis', 55: 'Chagas disease', 56: 'Chalazion', 57: 'Chicken pox', 58: 'Chickenpox', 59: 'Chikungunya Fever', 60: 'Childhood Exotropia', 61: 'Chlamydia', 62: 'Cholera', 63: 'Chorea', 64: 'Chronic cholestasis', 65: 'Chronic fatigue syndrome', 66: 'Chronic obstructive pulmonary disease (COPD)', 67: 'Cleft Lip and Cleft Palate', 68: 'Colitis', 69: 'Colorectal Cancer', 70: 'Common Cold', 71: 'Common cold', 72: 'Condyloma', 73: 'Congenital anomalies (birth defects)', 74: 'Congestive heart disease', 75: 'Corneal Abrasion', 76: 'Coronary Heart Disease', 77: 'Coronavirus disease 2019 (COVID-19)', 78: 'Cough', 79: 'Crimean Congo haemorrhagic fever (CCHF)', 80: 'Dehydration', 81: 'Dementia', 82: 'Dengue', 83: 'Diabetes ', 84: 'Diabetes Mellitus', 85: 'Diabetic Retinopathy', 86: 'Diarrhea', 87: 'Dimorphic hemmorhoids(piles)', 88: 'Diphtheria', 89: "Down's Syndrome", 90: 'Dracunculiasis (guinea-worm disease)', 91: 'Drug Reaction', 92: 'Dysentery', 93: 'Ear infection', 94: 'Early pregnancy loss', 95: 'Ebola', 96: 'Eclampsia', 97: 'Ectopic pregnancy', 98: 'Eczema', 99: 'Endometriosis', 100: 'Epilepsy', 101: 'Fibroids', 102: 'Fibromyalgia', 103: 'Food Poisoning', 104: 'Frost Bite', 105: 'Fungal infection', 106: 'GERD', 107: 'Gaming disorder', 108: 'Gangrene', 109: 'Gastroenteritis', 110: 'Genital herpes', 111: 'Glaucoma', 112: 'Goitre', 113: 'Gonorrhea', 114: 'Guillain-Barré syndrome', 115: 'Haemophilia', 116: 'Hand, Foot and Mouth Disease', 117: 'Heart attack', 118: 'Heat-Related Illnesses and Heat waves', 119: 'Hepatitis', 120: 'Hepatitis A', 121: 'Hepatitis B', 122: 'Hepatitis C', 123: 'Hepatitis D', 124: 'Hepatitis E', 125: 'Herpes Simplex', 126: 'High risk pregnancy', 127: 'Human papillomavirus', 128: 'Hypermetropia', 129: 'Hypertension ', 130: 'Hyperthyroidism', 131: 'Hypoglycemia', 132: 'Hypothyroid', 133: 'Hypothyroidism', 134: 'Hypotonia', 135: 'Impetigo', 136: 'Inflammatory Bowel Disease', 137: 'Influenza', 138: 'Insomnia', 139: 'Interstitial cystitis', 140: 'Iritis', 141: 'Iron Deficiency Anemia', 142: 'Irritable bowel syndrome', 143: 'Japanese Encephalitis', 144: 'Jaundice', 145: 'Kala-azar/ Leishmaniasis', 146: 'Kaposi’s Sarcoma', 147: 'Keratoconjunctivitis Sicca (Dry eye syndrome)', 148: 'Keratoconus', 149: 'Kuru', 150: 'Laryngitis', 151: 'Lead poisoning', 152: 'Legionellosis', 153: 'Leprosy', 154: 'Leptospirosis', 155: 'Leukemia', 156: 'Lice', 157: 'Lung cancer', 158: 'Lupus erythematosus', 159: 'Lyme disease', 160: 'Lymphoma', 161: 'Mad cow disease', 162: 'Malaria', 163: 'Marburg fever', 164: 'Mastitis', 165: 'Measles', 166: 'Melanoma', 167: 'Middle East respiratory syndrome coronavirus (MERS‐CoV)', 168: 'Migraine', 169: 'Mononucleosis', 170: 'Mouth Breathing', 171: 'Multiple myeloma', 172: 'Multiple sclerosis', 173: 'Mumps', 174: 'Muscular dystrophy', 175: 'Myasthenia gravis', 176: 'Myelitis', 177: 'Myocardial Infarction (Heart Attack)', 178: 'Myopia', 179: 'Narcolepsy', 180: 'Nasal Polyps', 181: 'Nausea and Vomiting of Pregnancy and  Hyperemesis gravidarum', 182: 'Necrotizing Fasciitis', 183: 'Neonatal Respiratory Disease Syndrome(NRDS)', 184: 'Neoplasm', 185: 'Neuralgia', 186: 'Nipah virus infection', 187: 'Obesity', 188: 'Obsessive Compulsive Disorder', 189: 'Oral Cancer', 190: 'Orbital Dermoid', 191: 'Osteoarthristis', 192: 'Osteoarthritis', 193: 'Osteomyelitis', 194: 'Osteoporosis', 195: 'Paralysis (brain hemorrhage)', 196: 'Paratyphoid fever', 197: "Parkinson's Disease", 198: 'Pelvic inflammatory disease', 199: 'Peptic ulcer diseae', 200: 'Perennial Allergic Conjunctivitis', 201: 'Pericarditis', 202: 'Peritonitis', 203: 'Pinguecula', 204: 'Pneumonia', 205: 'Poliomyelitis', 206: 'Polycystic ovary syndrome (PCOS)', 207: 'Porphyria', 208: 'Post Menopausal Bleeding', 209: 'Post-herpetic neuralgia', 210: 'Postpartum depression/ Perinatal depression', 211: 'Preeclampsia', 212: 'Premenstrual syndrome', 213: 'Presbyopia', 214: 'Preterm birth', 215: 'Progeria', 216: 'Psoriasis', 217: 'Puerperal sepsis', 218: 'Pulmonary embolism', 219: 'Ques fever', 220: 'Quinsy', 221: 'Rabies', 222: "Raynaud's Phenomenon", 223: 'Repetitive strain injury', 224: 'Rheumatic fever', 225: 'Rheumatism', 226: 'Rickets', 227: 'Rift Valley fever', 228: 'Rocky Mountain spotted fever', 229: 'Rubella', 230: 'SARS', 231: 'SIDS', 232: 'Sarcoidosis', 233: 'Sarcoma', 234: 'Scabies', 235: 'Scarlet fever', 236: 'Schizophrenia', 237: 'Sciatica', 238: 'Scrapie', 239: 'Scrub Typhus', 240: 'Scurvy', 241: 'Sepsis', 242: 'Sexually transmitted infections (STIs)', 243: 'Shaken Baby Syndrome', 244: 'Shigellosis', 245: 'Shin splints', 246: 'Shingles', 247: 'Sickle-cell anemia', 248: 'Smallpox', 249: 'Stevens-Johnson syndrome', 250: 'Stomach ulcers', 251: 'Strep throat', 252: 'Stroke', 253: 'Sub-conjunctival Haemorrhage', 254: 'Syphilis', 255: 'Taeniasis', 256: 'Taeniasis/cysticercosis', 257: 'Tay-Sachs disease', 258: 'Tennis elbow', 259: 'Tetanus', 260: 'Thalassaemia', 261: 'Tinnitus', 262: 'Tonsillitis', 263: 'Toxic shock syndrome', 264: 'Trachoma', 265: 'Trichinosis', 266: 'Trichomoniasis', 267: 'Tuberculosis', 268: 'Tularemia', 269: 'Turners Syndrome', 270: 'Typhoid', 271: 'Urinary tract infection', 272: 'Urticaria', 273: 'Varicose Veins', 274: 'Varicose veins', 275: 'Vasovagal syncope', 276: 'Vitamin B12 Deficiency', 277: 'Vitiligo', 278: 'Warkany syndrome', 279: 'Warts', 280: 'Yaws', 281: 'Yellow Fever', 282: 'Zika virus disease', 283: 'hepatitis A', 284: 'lactose intolerance', 285: 'papilloedema'}
def predict_disease(nk):
    input_vector = np.zeros(len(simp))
    fg=nk.strip()
    symptoms=[s.strip() for s in fg.split(',')]
    for s in symptoms:
        s = s.lower().strip()
        if s in simp:
            input_vector[simp[s]] = 1
        else:
            print(f"Warning: '{s}' not found in symptom list")
    probabilities = rfc.predict_proba([input_vector])[0]
    top3_idx = np.argsort(probabilities)[-3:][::-1]
    results = []
    for i in top3_idx:
        disease_name = dimp.get(i, f"Unknown disease {i}")
        prob = probabilities[i] * 100
        results.append((disease_name, round(prob, 2)))
    return results
def get_medicines(disease_name):
    row = med[med["Disease"].str.lower() == disease_name.lower()]
    if row.empty:
        return None
    medicines = row.iloc[0, 1:].dropna().tolist()
    return medicines
def get_diets(disease_name):
    row = diets[diets["Disease"].str.lower() == disease_name.lower()]
    if row.empty:
        return None
    diet = row.iloc[0, 1:].dropna().tolist()
    return diet
def get_desc(disease_name):
    row = descr[descr["Disease"].str.lower() == disease_name.lower()]
    if row.empty:
        return None
    desc = row.iloc[0, 1:].dropna().tolist()
    return desc
def get_work(disease_name):
    row = work[work["Disease"].str.lower() == disease_name.lower()]
    if row.empty:
        return None
    wo = row.iloc[0, 1:].dropna().tolist()
    return wo
def is_valid_input(nk):
    nk = nk.strip().lower()
    if not nk or re.fullmatch(r"[^\w\s,]+", nk):
        return False
    symptoms = [s.strip() for s in nk.split(",") if s.strip()]
    valid_symptoms = [s for s in symptoms if s in simp]
    return len(valid_symptoms) >= 1
def do_somting(nk):
    predictions = predict_disease(nk)
    if not is_valid_input(nk) or not predictions:
        return {
            "dis": "No disease detected",
            "desc":[],
            "med": [],
            "diet": [],
            "work": []
        }
    top1=predictions[0][0]
    med=get_medicines(top1)
    desc=get_desc(top1)
    dirt=get_diets(top1)
    work=get_work(top1)
    we='top 1 = '
    for dis,prob in predictions:
        we+=f'{dis} ~> {prob}%\n'
    return {
        "dis": we,
        "desc":desc,
        "med": med,
        "diet": dirt,
        "work": work
    }
app = Flask(__name__)
@app.route('/')
def index():
    return render_template("index.html")
@app.route('/process', methods=['POST'])
def process():
    data = request.get_json()
    user_input = data['text']
    result = do_somting(user_input)
    return jsonify(result)
if __name__ == '__main__':
    app.run(debug=True)